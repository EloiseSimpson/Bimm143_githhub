---
title: "Class10: Structural Bioinformatics (pt.1)"
author: "Eloise Simpson A19246982"
format: pdf
toc: true
---

## The PDB database

The [Protein Data Bank (PDB)](http://www.rcsb.org/) is the main repository of biomolecular structure data. Let's see what is in it:

```{r}
stats <- read.csv("/Users/eloisesimpson/Documents/BIMM143/Class10_structure/pdbstats26.csv", row.names=1)
stats
```

>Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

```{r}
n.sums <- colSums(stats)
n <- n.sums/n.sums["Total"]
round(n, digits=2)
```
> What is the total number of entries in the PDB?

```{r}
n.sums["Total"]
```


>Q2: What proportion of structures in the PDB are protein?

>Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

## Using Molstar

We can use the main [Molstar viewer online](https://molstar.org/viewer/):

![First view of HIV-Pr dimer with bound inhibitor](1HSG.png)


>Q. Generate and insert an image of the HIV-Pr cartoon colored by secondary structure, showing the inhibitor (ligand) in spacefill.

![First view of HIV-Pr dimer with bound inhibitor](1HSG-2.png)
>Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.
all important active site water molecule as spacefill

![First view of HIV-Pr dimer with bound inhibitor](1HSG-4.png)
## The Bio3D package for structural bioinformatics

```{r}
library(bio3d)

hiv <- read.pdb("1HSG")
hiv
```

```{r}
head(hiv$atom)
```

```{r}
pdbseq(hiv)
```

Let's try out the new **bio3dview** package that is not yet on CRAN. We can use the **remotes** package to install any R package from GitHub.

### Quick viewing of PDBs

```{r}
library("bio3dview")
#view.pdb(hiv)

sele <- atom.select(hiv, resno = 25)
#view.pdb(hiv, backgroundColor = "pink")
  #         highlight = sele
    #      highlight.style = "spacefill"
```
### Prediction of Protein dynamics

adenylate kinase: used to control relative proportions of nucleotides.
```{r}
adk <- read.pdb("6s36")
m <- nma(adk)
plot(m)
```
Write out our results as a wee trajectory movie:

```{r}
mktrj(m,file="results.pdb")
```

```{r}
#view.nma(m)
```

## Comparative protein structure analysis with PCA

We start with a database identifier "1ake_A"
```{r}
library(bio3d)
id <- "1ake_A"
aa <- get.seq(id)
```
```{r}
blast <- blast.pdb(aa)
```
have a week peak:
```{r}
head(blast$hit.tbl)
```
```{r}
hits <- plot(blast)
```
Each dot is a hit from BLAST.

Peak at our "top hits"
```{r}
head(hits$pdb.id)
```

Now we can download these  "top hits" these will all be ADK (adenylate kinase) structures in the PDB database.
```{r}
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```
Gzip compresses before download, splitting up the files.

We need one package from BioConductor. To set this up we need to first install a package called **"BiocManager"** from CRAN.

Now we can use the `install( )` function from this package like this: `BiocManager::install("msa")`

```{r}
pdbs <- pdbaln(files, fit=TRUE, exefile="msa")
```
fit = TRUE stores them in a better way, not as structure on molstar.

Let's have a week peak at our structures after "fitting" or superposing:
```{r}
library(bio3dview)
#view.pdbs(pdbs)
```
```{r}
#view.pdbs(pdbs, colorScheme = "residue")
```

We can run functions like `rmsd()`, `rmsf90` and the best `pca()`

```{r}
pc.xray <- pca(pdbs)
plot(pc.xray)
```

```{r}
plot(pc.xray, 1:2)
```
Finally, let's make a wee movie of the major "motion" or structural difference in the dataset - we call this a "trajectory".

```{r}
mktrj(pc.xray, file = "results.pdb")
```

